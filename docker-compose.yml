# Docker Compose file for Open WebUI and Portainer
# Version specifies the file format. '3.8' is a recent, stable version.
version: '3.8'

services:
  # Defines the Open WebUI service
  open-webui:
    image: ghcr.io/open-webui/open-webui:main
    container_name: open-webui
    volumes:
      - open-webui:/app/backend/data
    ports:
      # Access Open WebUI at http://localhost:3000
      - "3000:8080"
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped

  # Defines the Portainer service for Docker management
  portainer:
    image: portainer/portainer-ce:latest
    container_name: portainer
    ports:
      # Portainer UI will be available on port 9443 (HTTPS)
      - "9443:9443"
      # Port 8000 is used for the tunnel server (optional but recommended)
      - "8000:8000"
    volumes:
      # Mounts the Docker socket to allow Portainer to manage Docker itself.
      - /var/run/docker.sock:/var/run/docker.sock
      # Persists Portainer's configuration data.
      - portainer_data:/data
    restart: always

# Defines the named volumes used by the services.
volumes:
  open-webui: {}
  portainer_data: {}
